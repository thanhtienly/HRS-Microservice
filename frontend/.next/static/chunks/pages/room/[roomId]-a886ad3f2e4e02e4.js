(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[986],{397:(e,t,l)=>{"use strict";l.d(t,{A:()=>a});var s=l(7876),o=l(4232);function a(e){let[t,l]=(0,o.useState)(!1);return(0,o.useEffect)(()=>{if(e.message){l(!0);let t=setTimeout(()=>{l(!1),e.onTimeOut(!1)},e.duration);return()=>{clearTimeout(t)}}},[e.duration]),(0,s.jsx)("div",{className:"w-[200] fixed flex flex-col text-black bg-green-500 rounded-md border-l-10 border-green-700 z-200 ".concat(t?"animate-fade-in top-[75] right-[20]":"hidden top-[75] right-[0]"),children:(0,s.jsx)("div",{className:"pt-2 pb-2 pl-3 pr-3 w-full",children:(0,s.jsx)("p",{children:e.message})})})}},2081:(e,t,l)=>{"use strict";l.r(t),l.d(t,{default:()=>f});var s=l(7876),o=l(4232),a=l(3825),n=l(397),r=l(6102);l(3451);var c=l(4e3);function i(e){let t=(0,c.useParams)(),[l,a]=(0,o.useState)(null),[n,r]=(0,o.useState)(0),[i,d]=(0,o.useState)(!1),u=async()=>await fetch("".concat("http://localhost:3001","/booking/total?roomId=").concat(null==t?void 0:t.roomId)).then(e=>e.json()).then(e=>{if(e.success)return e.data}).catch(e=>{});return((0,o.useEffect)(()=>{if(e.isBookSuccess){d(e.isBookSuccess);let t=setTimeout(()=>{d(!1),e.onRefresh()},1e3);return()=>{clearTimeout(t)}}},[e.isBookSuccess]),(0,o.useEffect)(()=>{(null==t?void 0:t.roomId)&&u().then(e=>{r(e)}).catch(e=>{console.log(e)})},[null==t?void 0:t.roomId]),(0,o.useEffect)(()=>{i&&(null==t?void 0:t.roomId)&&u().then(e=>{r(e)}).catch(e=>{console.log(e)})},[i]),(0,o.useEffect)(()=>{(null==t?void 0:t.roomId)&&(async()=>await fetch("".concat("http://localhost:3001","/room/").concat(t.roomId)).then(e=>e.json()).then(e=>{if(e.success)return e.data}).catch(e=>{}))().then(e=>{a(e)}).catch(e=>{console.log(e)})},[null==t?void 0:t.roomId]),l)?(0,s.jsxs)("div",{className:"w-full lg:w-fit lg:min-w-xs lg:h-fit mt-[20] flex flex-col bg-slate-900 p-4 rounded-lg text-sm text-white shadow-xl",children:[(0,s.jsxs)("p",{id:"roomName",children:[(0,s.jsx)("b",{className:"text-yellow-400",children:"Room Name: "}),null==l?void 0:l.name]}),(0,s.jsxs)("p",{id:"building",children:[(0,s.jsx)("b",{className:"text-yellow-400",children:"Building: "}),null==l?void 0:l.building]}),(0,s.jsxs)("p",{id:"roomFloor",children:[(0,s.jsx)("b",{className:"text-yellow-400",children:"Floor: "}),null==l?void 0:l.floor]}),(0,s.jsxs)("p",{id:"roomType",children:[(0,s.jsx)("b",{className:"text-yellow-400",children:"Room type: "}),null==l?void 0:l.type]}),(0,s.jsxs)("p",{id:"roomCapacity",children:[(0,s.jsx)("b",{className:"text-yellow-400",children:"Capacity: "}),null==l?void 0:l.capacity]}),(0,s.jsxs)("div",{className:"flex flex-row justify-end italic font-bold mt-2",children:[(0,s.jsx)("p",{children:"Total reservations: "}),(0,s.jsx)("p",{className:"ml-2 text-yellow-400",children:n})]})]}):(0,s.jsx)("div",{})}var d=l(3616);function u(e){let t={"":"Unknown error","Invalid Token":"Login required","Access Token expired":"Login required"};var l=Object.keys(t);for(let s=0;s<l.length;s++)if(e==l[s])return Object.values(t)[s];return e}let m=e=>{let[t,l]=(0,o.useState)(!1);return(0,s.jsx)("button",{onClick:"available"==e.status?s=>{s.preventDefault();var o=s.target;if(0==o.tabIndex){l(!t),e.onSelect(o.textContent,"choose"),o.tabIndex=1;return}l(!t),e.onSelect(o.textContent,"cancel"),o.tabIndex=0}:()=>{},tabIndex:0,className:"time-slot mt-1 mb-1 ml-2 mr-2 pt-1 pb-1 pl-3 pr-3 rounded-md \n        ".concat("booked"==e.status?"bg-red-500":"".concat(t?"bg-black text-white":"bg-blue-500 hover:bg-lime-500"," cursor-pointer")),children:e.time})};function x(e){let[t,l]=(0,o.useState)(),a=(0,c.useParams)(),[n,r]=(0,o.useState)([]),[i,x]=(0,o.useState)(""),[h,f]=(0,o.useState)([]);(0,o.useEffect)(()=>{var e=(0,d.getCookie)("accessToken");e&&l(e)},[]);let p=async()=>{await fetch("".concat("http://localhost:3001","/booking/time-slot?date=").concat(i,"&roomId=").concat(null==a?void 0:a.roomId),{method:"GET",headers:{"Content-Type":"application/json"}}).then(e=>e.json()).then(t=>{if(t.success)return void r(t.data);e.onError(!0,null==t?void 0:t.message)}).catch(e=>{console.log(e)})};(0,o.useEffect)(()=>{i&&(p(),f([]))},[i]);let g=(e,t)=>{if("choose"==t){h.push(e),f(h);return}f(h.filter(t=>t!=e))},b=async l=>{console.log(h),l.preventDefault(),i&&0!=h.length&&await fetch("".concat("http://localhost:3001","/booking/time-slot"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)},body:JSON.stringify({date:i,roomId:null==a?void 0:a.roomId,timeSlot:h})}).then(e=>e.json()).then(t=>{if(!t.success){e.onError(!0,u(null==t?void 0:t.message)),e.onBook(!1);return}e.onSuccess(!0,"Book the time slot successfully"),e.onBook(!0),f([]),p()}).catch(t=>{console.log(t),e.onBook(!1)})};return(0,s.jsxs)("div",{className:"mt-[20] h-fit flex flex-col p-4 shadow-xl rounded-lg bg-slate-300 text-sm lg:mr-[20] lg:w-2/3",children:[(0,s.jsxs)("div",{className:"flex flex-col text-xs",children:[(0,s.jsx)("label",{htmlFor:"date-picker",className:"mb-1 text-xs font-semibold",children:"Select date"}),(0,s.jsx)("input",{onChange:e=>{e.preventDefault(),x(e.target.value)},type:"date",name:"date-picker",id:"date-picker",className:"border-[1] pt-1 pb-1 pl-3 pr-3 rounded-lg outline-none hover:border-blue-700"})]}),(0,s.jsxs)("div",{className:"flex flex-col text-xs",children:[(0,s.jsx)("label",{className:"mb-1 text-xs font-semibold mt-3",children:"Select time slot"}),(0,s.jsx)("div",{className:"flex flex-row flex-wrap",children:n.map(e=>(0,s.jsx)(m,{time:"".concat(e.startTime," - ").concat(e.endTime),status:"".concat(e.status),onSelect:g},"".concat(e.date,"T").concat(e.startTime)))}),(0,s.jsx)("div",{className:"mt-3 w-full flex flex-column justify-center",children:(0,s.jsxs)("div",{className:"w-fit max-w-md flex flex-row justify-around",children:[(0,s.jsxs)("div",{className:"mr-2 ml-2 flex flex-row items-center",children:[(0,s.jsx)("span",{className:"w-[10] h-[10] bg-red-500"}),(0,s.jsx)("label",{className:"ml-2",children:"Booked"})]}),(0,s.jsxs)("div",{className:"mr-2 ml-2 flex flex-row items-center",children:[(0,s.jsx)("span",{className:"w-[10] h-[10] bg-black"}),(0,s.jsx)("label",{className:"ml-2",children:"Selected"})]}),(0,s.jsxs)("div",{className:"mr-2 ml-2 flex flex-row items-center",children:[(0,s.jsx)("span",{className:"w-[10] h-[10] bg-blue-500"}),(0,s.jsx)("label",{className:"ml-2",children:"Available"})]})]})})]}),(0,s.jsx)("div",{className:"mt-3 w-full",children:(0,s.jsx)("button",{onClick:b,className:"w-full pt-2 pb-2 bg-slate-900 text-white rounded-lg hover:bg-black cursor-pointer",children:"Book"})})]})}function h(e){let t=(0,c.useParams)(),[l,a]=(0,o.useState)(),[n,r]=(0,o.useState)([]),i=(0,o.useRef)(null),m=e=>{e&&fetch("".concat("http://localhost:3001","/room/").concat(e,"/feedback"),{headers:{"Content-Type":"application/json"}}).then(e=>e.json()).then(e=>{if(e.success)return void r(e.data)}).catch(e=>{console.log(e)})};(0,o.useEffect)(()=>{m(null==t?void 0:t.roomId)},[null==t?void 0:t.roomId]),(0,o.useEffect)(()=>{var e=(0,d.getCookie)("accessToken");e&&a(e)},[]);let x=async s=>{await fetch("".concat("http://localhost:3001","/room/").concat(null==t?void 0:t.roomId,"/feedback"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(l)},body:JSON.stringify({content:s})}).then(e=>e.json()).then(t=>{if(!t.success)return void e.onError(!0,u(null==t?void 0:t.message))}).catch(e=>{console.log(e)}),m(null==t?void 0:t.roomId)},h=async e=>{if(13==e.keyCode&&!1==e.shiftKey&&(e.preventDefault(),i.current)){let e=i.current.value;await x(e),i.current.value=""}};return(0,s.jsxs)("div",{className:"mt-[20] mb-[20] h-fit flex flex-col p-4 shadow-xl rounded-lg bg-yellow-100 text-sm lg:ml-[20] lg:w-1/3 lg:mr-[20]",children:[(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("label",{htmlFor:"feedback",className:"text-xs mb-1 italic font-bold",children:"Your feedback"}),(0,s.jsx)("textarea",{name:"feedback",id:"feedback",className:"pt-1 pb-1 pl-2 pr-2 bg-white rounded-sm outline-none text-wrap resize-none",rows:2,placeholder:"Input your feedback",onKeyDown:h,ref:i})]}),(0,s.jsx)("div",{className:"flex flex-col",children:n.map(e=>(0,s.jsxs)("div",{className:"mt-[10] flex flex-col pt-2 pb-2 pr-3 pl-3 bg-gray-50 rounded-md",children:[(0,s.jsxs)("div",{className:"flex flex-row text-xs",children:[(0,s.jsx)("p",{className:"w-1/2 text-left font-bold",children:e.studentName}),(0,s.jsx)("p",{className:"w-1/2 text-right italic",children:e.date})]}),(0,s.jsx)("p",{children:e.content})]},e.id))})]})}function f(){let[e,t]=(0,o.useState)(!1),[l,c]=(0,o.useState)(""),[d,u]=(0,o.useState)(!1),[m,f]=(0,o.useState)(""),[p,g]=(0,o.useState)(!1),b=(e,l)=>{t(e),c(l)},w=(e,t)=>{u(e),f(t)};return(0,s.jsxs)(s.Fragment,{children:[e&&(0,s.jsx)(a.A,{message:l,duration:3e3,onTimeOut:e=>{t(e)}}),d&&(0,s.jsx)(n.A,{message:m,duration:3e3,onTimeOut:e=>{u(e)}}),(0,s.jsxs)("div",{className:"w-full lg:h-screen lg:overflow-hidden",children:[(0,s.jsx)(r.A,{}),(0,s.jsxs)("div",{className:"w-full lg:h-screen flex flex-col lg:flex-row pt-[80] pb-[80] pl-[20] pr-[20]",children:[(0,s.jsx)(i,{isBookSuccess:p,onRefresh:()=>{g(!1)}}),(0,s.jsxs)("div",{className:"w-full lg:h-screen lg:overflow-scroll lg:pl-[50] flex flex-col lg:flex-row",children:[(0,s.jsx)(x,{onBook:e=>{g(e)},onError:b,onSuccess:w}),(0,s.jsx)(h,{onError:b,onSuccess:w})]})]})]})]})}},3451:()=>{},3825:(e,t,l)=>{"use strict";l.d(t,{A:()=>a});var s=l(7876),o=l(4232);function a(e){let[t,l]=(0,o.useState)(!1);return(0,o.useEffect)(()=>{if(e.message){l(!0);let t=setTimeout(()=>{l(!1),e.onTimeOut(!1)},e.duration);return()=>{clearTimeout(t)}}},[e.duration]),(0,s.jsx)("div",{className:"min-w-[200] max-w-[250] fixed flex flex-col text-white bg-red-500 rounded-md border-l-10 border-red-700 z-200 ".concat(t?"animate-fade-in top-[75] right-[20]":"hidden top-[75] right-[0]"),children:(0,s.jsx)("div",{className:"pt-2 pb-2 pl-3 pr-3 w-full",children:(0,s.jsx)("p",{className:"whitespace-pre-line",children:e.message})})})}},5769:(e,t,l)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/room/[roomId]",function(){return l(2081)}])},6102:(e,t,l)=>{"use strict";l.d(t,{A:()=>d});var s=l(7876);l(3451);var o=l(4587),a=l.n(o),n=l(9840),r=l(4232),c=l(9099),i=l(8248);function d(){let e=(0,c.useRouter)(),t=(0,i.useGetCookie)(),l=(0,i.useDeleteCookie)(),[o,d]=(0,r.useState)(!0),[u,m]=(0,r.useState)(!1),x=()=>{if(window.innerWidth<1280)return void d(!0);d(!1)};return(0,r.useEffect)(()=>{t("accessToken")&&m(!0)},[t]),(0,r.useEffect)(()=>{x()},[]),(0,r.useEffect)(()=>(window.addEventListener("resize",x),()=>window.removeEventListener("resize",x)),[]),(0,s.jsxs)("nav",{className:"fixed w-full bg-slate-900 p-2 flex flex-wrap items-center xl:flex-row sm:flex-col z-100",children:[(0,s.jsxs)("div",{className:"logo-container flex flex-row w-full xl:w-1/3",children:[(0,s.jsx)("div",{className:"wrap-logo w-1/2",children:(0,s.jsx)("a",{href:"/",className:"flex max-w-fit",children:(0,s.jsx)(a(),{src:"/logo.jpg",alt:"Logo",width:100,height:50,className:"ml-4"})})}),(0,s.jsx)("div",{className:"wrap-expand w-1/2 flex justify-end xl:hidden",children:(0,s.jsx)("div",{onClick:()=>{if(o)return void d(!o);d(!o)},children:(0,s.jsx)(n.A,{fontSize:"large",className:"cursor-pointer",sx:{color:"white"}})})})]}),(0,s.jsxs)("div",{className:"page flex flex-col justify-start xl:flex-row xl:justify-center w-full xl:w-1/3 ".concat(o?"hidden":""),children:[(0,s.jsx)("a",{href:"/room",className:"ml-4 mr-4 mt-1 mb-1 p-2 cursor-pointer text-white hover:bg-yellow-400 hover:text-slate-950 hover:rounded-md",children:"Booking"}),(0,s.jsx)("a",{href:"/booking-history",className:"ml-4 mr-4 mt-1 mb-1 p-2 cursor-pointer text-white hover:bg-yellow-400 hover:text-slate-950 hover:rounded-md",children:"History"})]}),(0,s.jsxs)("div",{className:"auth flex justify-start xl:justify-end w-full xl:w-1/3 ".concat(o?"hidden":""),children:[!1==u&&(0,s.jsx)("a",{className:"ml-4 mr-4 mt-1 mb-1 cursor-pointer pt-2 pb-2 pl-4 pr-4 bg-white text-slate-950 rounded-lg hover:bg-yellow-400",href:"/login",children:"Login"}),u&&(0,s.jsx)("button",{className:"ml-4 mr-4 mt-1 mb-1 cursor-pointer pt-2 pb-2 pl-4 pr-4 bg-white text-slate-950 rounded-lg hover:bg-yellow-400",onClick:()=>{l("accessToken"),l("refreshToken"),console.log("Reload"),e.reload()},children:"Logout"})]})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[327,0,3,636,593,792],()=>t(5769)),_N_E=e.O()}]);